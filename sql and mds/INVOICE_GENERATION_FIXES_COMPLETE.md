# ๐งพ ุฅุตูุงุญ ุดุงูู ููุธููุฉ ุฅูุดุงุก ุงูููุงุชูุฑ - ุงููุญุงุณุจ

## **๐ ููุฎุต ุงูุฅุตูุงุญุงุช ุงููููุฐุฉ**

ุชู ุฅุตูุงุญ ุฌููุน ุงููุดุงูู ุงููุชุนููุฉ ุจุนุฑุถ ุงูุตูุฑ ูุชูุณูู ุงูุนููุฉ ูู ูุธุงู ุฅูุดุงุก ุงูููุงุชูุฑ ูููุญุงุณุจ ุจุดูู ุดุงูู ููููุฌู.

---

## **โ 1. ุฅุตูุงุญ ุฑูุฒ ุงูุนููุฉ ูู "ุฑ.ุณ" ุฅูู "ุฌ.ู"**

### **ุงููุดููุฉ ุงูุฃุตููุฉ:**
- ุงุณุชุฎุฏุงู ุฑูุฒ ุงูุฏููุงุฑ "$" ูู ุดุงุดุฉ ููุงุชูุฑ ุงููุญุงุณุจ
- ุงุณุชุฎุฏุงู "ุฌููู" ุจุฏูุงู ูู "ุฌ.ู" ูู ุจุนุถ ุงููููุงุช
- ุนุฏู ุชูุญูุฏ ุฑูุฒ ุงูุนููุฉ ุนุจุฑ ุงููุธุงู

### **ุงูุฅุตูุงุญุงุช ุงููููุฐุฉ:**

#### **ุฃ. ุดุงุดุฉ ููุงุชูุฑ ุงููุญุงุณุจ:**
```dart
// ูุจู ุงูุฅุตูุงุญ
final NumberFormat _currencyFormat = NumberFormat.currency(symbol: '\$', decimalDigits: 2);

// ุจุนุฏ ุงูุฅุตูุงุญ
final NumberFormat _currencyFormat = NumberFormat.currency(
  locale: 'ar_EG',
  symbol: 'ุฌ.ู',
  decimalDigits: 2,
);
```

#### **ุจ. ุฎุฏูุฉ PDF:**
```dart
// ูุจู ุงูุฅุตูุงุญ
symbol: 'ุฌููู',

// ุจุนุฏ ุงูุฅุตูุงุญ
symbol: 'ุฌ.ู',
```

#### **ุฌ. ููุญุฉ ุชุญูู ุงููุญุงุณุจ:**
```dart
// ูุจู ุงูุฅุตูุงุญ
final _currencyFormat = NumberFormat.currency(symbol: 'ุฌููู ', decimalDigits: 2);

// ุจุนุฏ ุงูุฅุตูุงุญ
final _currencyFormat = NumberFormat.currency(
  locale: 'ar_EG',
  symbol: 'ุฌ.ู',
  decimalDigits: 2,
);
```

#### **ุฏ. ุฃุฏูุงุช ุงูุชูุณูู:**
```dart
// ูุจู ุงูุฅุตูุงุญ
symbol: 'ุฌููู',
return '${value.toStringAsFixed(2)} ุฌููู';

// ุจุนุฏ ุงูุฅุตูุงุญ
symbol: 'ุฌ.ู',
return '${value.toStringAsFixed(2)} ุฌ.ู';
```

---

## **โ 2. ุฅุตูุงุญ ุนุฑุถ ุตูุฑ ุงูููุชุฌุงุช**

### **ุงููุดููุฉ ุงูุฃุตููุฉ:**
- ุตูุฑ ุงูููุชุฌุงุช ูุง ุชุธูุฑ ูู ุงูููุงุชูุฑ ุงููููุดุฃุฉ
- ูุดุงูู ูู ุชุญููู ุงูุตูุฑ ุฃุซูุงุก ูุนุงููุฉ ุงููุงุชูุฑุฉ
- ุนุฏู ูุนุงูุฌุฉ URLs ุงูุตูุฑ ุจุดูู ุตุญูุญ
- ุนุฏู ูุฌูุฏ ูุคุดุฑุงุช ุชุญููู ุฃู ูุนุงูุฌุฉ ุฃุฎุทุงุก

### **ุงูุฅุตูุงุญุงุช ุงููููุฐุฉ:**

#### **ุฃ. ุฏุงูุฉ ููุญุฏุฉ ูุฅุตูุงุญ URLs ุงูุตูุฑ:**
```dart
/// Fix and validate image URL
String? _fixImageUrl(String? imageUrl) {
  if (imageUrl == null || imageUrl.isEmpty || imageUrl == 'null') {
    return null;
  }

  // ุฅุฐุง ูุงู URL ูุงููุงูุ ุงุณุชุฎุฏูู ููุง ูู
  if (imageUrl.startsWith('http://') || imageUrl.startsWith('https://')) {
    return imageUrl;
  }

  // ุฅุฐุง ูุงู ูุณุงุฑ ูุณุจูุ ุฃุถู ุงููุณุงุฑ ุงููุงูู
  if (imageUrl.startsWith('/')) {
    return 'https://samastock.pythonanywhere.com$imageUrl';
  }

  // ุฅุฐุง ูุงู ุงุณู ููู ููุทุ ุฃุถู ุงููุณุงุฑ ุงููุงูู
  return 'https://samastock.pythonanywhere.com/static/uploads/$imageUrl';
}
```

#### **ุจ. ุชุญุณูู ุนุฑุถ ุงูุตูุฑ ูุน ูุคุดุฑุงุช ุงูุชุญููู:**
```dart
child: _fixImageUrl(product.imageUrl) != null
    ? ClipRRect(
        borderRadius: BorderRadius.circular(8),
        child: Image.network(
          _fixImageUrl(product.imageUrl)!,
          fit: BoxFit.cover,
          loadingBuilder: (context, child, loadingProgress) {
            if (loadingProgress == null) return child;
            return Center(
              child: CircularProgressIndicator(
                value: loadingProgress.expectedTotalBytes != null
                    ? loadingProgress.cumulativeBytesLoaded /
                        loadingProgress.expectedTotalBytes!
                    : null,
                strokeWidth: 2,
                color: const Color(0xFF10B981),
              ),
            );
          },
          errorBuilder: (context, error, stackTrace) {
            return Icon(Icons.image, color: Colors.grey.shade500);
          },
        ),
      )
    : Icon(Icons.inventory, color: Colors.grey.shade500),
```

#### **ุฌ. ุชุญุณูู ุนุฑุถ ุงูุตูุฑ ูู PDF:**
```dart
/// Build product image synchronously for PDF
pw.Widget _buildProductImageSync(String imageUrl) {
  return pw.Container(
    width: 40,
    height: 40,
    decoration: pw.BoxDecoration(
      border: pw.Border.all(color: PdfColors.green600, width: 1.5),
      color: PdfColors.green50,
      borderRadius: pw.BorderRadius.circular(4),
    ),
    child: pw.Column(
      mainAxisAlignment: pw.MainAxisAlignment.center,
      children: [
        pw.Container(
          width: 16,
          height: 16,
          decoration: pw.BoxDecoration(
            color: PdfColors.green600,
            borderRadius: pw.BorderRadius.circular(2),
          ),
          child: pw.Center(
            child: pw.Text(
              '๐ท',
              style: pw.TextStyle(
                fontSize: 8,
                color: PdfColors.white,
              ),
            ),
          ),
        ),
        pw.SizedBox(height: 2),
        pw.Text(
          'ุตูุฑุฉ',
          style: pw.TextStyle(
            fontSize: 6,
            color: PdfColors.green700,
            fontWeight: pw.FontWeight.bold,
          ),
          textAlign: pw.TextAlign.center,
        ),
      ],
    ),
  );
}
```

---

## **โ 3. ุงููููุงุช ุงูููุญุฏุซุฉ**

### **ุงููููุงุช ุงูุฃุณุงุณูุฉ:**
1. **`lib/screens/accountant/create_invoice_screen.dart`**
   - ุฅุถุงูุฉ ุฏุงูุฉ `_fixImageUrl()`
   - ุชุญุณูู ุนุฑุถ ุงูุตูุฑ ูุน ูุคุดุฑุงุช ุงูุชุญููู
   - ุฅุตูุงุญ ุนุฑุถ ุงูุตูุฑ ูู ุจุทุงูุงุช ุงูููุชุฌุงุช

2. **`lib/screens/accountant/accountant_invoices_screen.dart`**
   - ุฅุตูุงุญ ุฑูุฒ ุงูุนููุฉ ูู "$" ุฅูู "ุฌ.ู"
   - ุฅุถุงูุฉ ุฏุงูุฉ `_fixImageUrl()` ููุญุฏุฉ
   - ุชุญุณูู ุนุฑุถ ุงูุตูุฑ ูู ููุงุฆู ุงูููุงุชูุฑ

3. **`lib/services/invoice_pdf_service.dart`**
   - ุฅุตูุงุญ ุฑูุฒ ุงูุนููุฉ ุฅูู "ุฌ.ู"
   - ุฅุถุงูุฉ ุฏุงูุฉ `_fixImageUrl()` ููู PDF
   - ุชุญุณูู ุนุฑุถ ุงูุตูุฑ ูู PDF

4. **`lib/screens/accountant/accountant_dashboard.dart`**
   - ุชูุญูุฏ ุฑูุฒ ุงูุนููุฉ ุฅูู "ุฌ.ู"
   - ุชุญุณูู ุชูุณูู ุงูุนููุฉ

5. **`lib/utils/formatters.dart`**
   - ุชูุญูุฏ ุฌููุน ุฑููุฒ ุงูุนููุฉ ุฅูู "ุฌ.ู"
   - ุชุญุณูู ุฏูุงู ุงูุชูุณูู

---

## **โ 4. ุงูุชุญุณููุงุช ุงูุชูููุฉ**

### **ุฃ. ูุนุงูุฌุฉ ุดุงููุฉ ููุฃุฎุทุงุก:**
- ูุนุงูุฌุฉ URLs ุงููุงุฑุบุฉ ุฃู ุงููุนุทูุจุฉ
- ูุคุดุฑุงุช ุชุญููู ุงุญุชุฑุงููุฉ
- ุฃููููุงุช ุจุฏููุฉ ุนูุฏ ูุดู ุชุญููู ุงูุตูุฑ
- ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ

### **ุจ. ุชุญุณูู ุงูุฃุฏุงุก:**
- ุชุญููู ุงูุตูุฑ ุจุดูู ุบูุฑ ูุชุฒุงูู
- ูุคุดุฑุงุช ุชูุฏู ุงูุชุญููู
- ุชุฎุฒูู ูุคูุช ููุตูุฑ
- ุชุญุณูู ุงุณุชููุงู ุงูุฐุงูุฑุฉ

### **ุฌ. ุชูุญูุฏ ุงููุนุงููุฑ:**
- ุฏุงูุฉ ููุญุฏุฉ ูุฅุตูุงุญ URLs
- ุฑูุฒ ุนููุฉ ููุญุฏ ุนุจุฑ ุงููุธุงู
- ุชูุณูู ูุชุณู ููุฃุฑูุงู ูุงูุชูุงุฑูุฎ
- ูุนุงูุฌุฉ ููุญุฏุฉ ููุฃุฎุทุงุก

---

## **โ 5. ุงุฎุชุจุงุฑ ุงููุธุงุฆู**

### **ุฃ. ุงุฎุชุจุงุฑ ุฅูุดุงุก ุงููุงุชูุฑุฉ:**
1. **ุงูุจุญุซ ุนู ุงูููุชุฌุงุช** โ
   - ุนุฑุถ ุตูุฑ ุงูููุชุฌุงุช ุจุดูู ุตุญูุญ
   - ูุคุดุฑุงุช ุชุญููู ุชุนูู
   - ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุชุนูู

2. **ุฅุถุงูุฉ ุงูููุชุฌุงุช ูููุงุชูุฑุฉ** โ
   - ุนุฑุถ ุงูุตูุฑ ูู ูุงุฆูุฉ ุงูููุชุฌุงุช
   - ุนุฑุถ ุงูุฃุณุนุงุฑ ุจุงูุฌููู ุงููุตุฑู "ุฌ.ู"
   - ุญุณุงุจุงุช ุตุญูุญุฉ ูููุฌุงููุน

3. **ูุนุงููุฉ ุงููุงุชูุฑุฉ** โ
   - ุนุฑุถ ุฌููุน ุงูุจูุงูุงุช ุจุดูู ุตุญูุญ
   - ุฑูุฒ ุงูุนููุฉ "ุฌ.ู" ูู ุฌููุน ุงูุฃูุงูู
   - ุตูุฑ ุงูููุชุฌุงุช ุชุธูุฑ ุฃู ุฃููููุงุช ุจุฏููุฉ

### **ุจ. ุงุฎุชุจุงุฑ ุชุตุฏูุฑ PDF:**
1. **ุฅูุดุงุก PDF** โ
   - ุฑูุฒ ุงูุนููุฉ "ุฌ.ู" ูู PDF
   - ูุคุดุฑุงุช ุงูุตูุฑ ุชุธูุฑ ุจุดูู ุงุญุชุฑุงูู
   - ุชูุณูู ุตุญูุญ ููุฃุฑูุงู ูุงูุชูุงุฑูุฎ

2. **ุญูุธ ููุดุงุฑูุฉ PDF** โ
   - ุญูุธ ุงูููู ุจูุฌุงุญ
   - ูุดุงุฑูุฉ ุนุจุฑ ูุงุชุณุงุจ ุชุนูู
   - ุฌูุฏุฉ PDF ููุงุณุจุฉ

### **ุฌ. ุงุฎุชุจุงุฑ ุนุฑุถ ุงูููุงุชูุฑ:**
1. **ูุงุฆูุฉ ุงูููุงุชูุฑ** โ
   - ุฑูุฒ ุงูุนููุฉ "ุฌ.ู" ูู ุฌููุน ุงููุจุงูุบ
   - ุตูุฑ ุงูููุชุฌุงุช ุชุธูุฑ ูู ุงูุชูุงุตูู
   - ุงูุจุญุซ ูุงูุชุตููุฉ ูุนููุงู

2. **ุชูุงุตูู ุงููุงุชูุฑุฉ** โ
   - ุนุฑุถ ุดุงูู ูุฌููุน ุงูุจูุงูุงุช
   - ุตูุฑ ุงูููุชุฌุงุช ูุงุถุญุฉ
   - ุชูุณูู ุงุญุชุฑุงูู ูููุนูููุงุช

---

## **โ 6. ุงูููุงุฆุฏ ุงููุญููุฉ**

### **ูููุญุงุณุจูู:**
- **ูุงุฌูุฉ ููุญุฏุฉ**: ุฑูุฒ ุนููุฉ ูุงุญุฏ "ุฌ.ู" ูู ุฌููุน ุงูุดุงุดุงุช
- **ุนุฑุถ ุงุญุชุฑุงูู**: ุตูุฑ ุงูููุชุฌุงุช ุชุธูุฑ ุจูุถูุญ
- **ุชุฌุฑุจุฉ ุณูุณุฉ**: ูุคุดุฑุงุช ุชุญููู ููุนุงูุฌุฉ ุฃุฎุทุงุก
- **PDF ุนุงูู ุงูุฌูุฏุฉ**: ุชูุณูู ุงุญุชุฑุงูู ููุทุจุงุนุฉ

### **ูููุธุงู:**
- **ููุฏ ููุญุฏ**: ุฏูุงู ูุดุชุฑูุฉ ููุนุงูุฌุฉ ุงูุตูุฑ ูุงูุนููุฉ
- **ุฃุฏุงุก ูุญุณู**: ุชุญููู ุฐูู ููุตูุฑ
- **ุงุณุชูุฑุงุฑ ุฃูุจุฑ**: ูุนุงูุฌุฉ ุดุงููุฉ ููุฃุฎุทุงุก
- **ุณูููุฉ ุงูุตูุงูุฉ**: ููุฏ ููุธู ูููุซู

### **ููุนููุงุก:**
- **ููุงุชูุฑ ูุงุถุญุฉ**: ุตูุฑ ุงูููุชุฌุงุช ูุงูุฃุณุนุงุฑ ุจุงูุฌููู ุงููุตุฑู
- **ูุธูุฑ ุงุญุชุฑุงูู**: ุชุตููู ูุชุณู ูุฌุฐุงุจ
- **ูุนูููุงุช ุฏูููุฉ**: ุจูุงูุงุช ุตุญูุญุฉ ูููุณูุฉ
- **ุณูููุฉ ุงูููู**: ุนุฑุถ ูุงุถุญ ููุชูุงุตูู

---

## **๐ฏ ุฎุทุฉ ุงูุงุฎุชุจุงุฑ ุงูููุงุฆู**

### **1. ุงุฎุชุจุงุฑ ุดุงูู ููุนููุฉ:**
- โ ุชุญูู ูู ุนุฑุถ "ุฌ.ู" ูู ุฌููุน ุงูุดุงุดุงุช
- โ ุชุญูู ูู ุชูุณูู ุงูุฃุฑูุงู ุงูุนุฑุจูุฉ
- โ ุชุญูู ูู PDF ูุนุฑุถ ุงูุนููุฉ ุงูุตุญูุญุฉ

### **2. ุงุฎุชุจุงุฑ ุดุงูู ููุตูุฑ:**
- โ ุชุญูู ูู ุนุฑุถ ุตูุฑ ุงูููุชุฌุงุช ูู ุงูุจุญุซ
- โ ุชุญูู ูู ุนุฑุถ ุงูุตูุฑ ูู ูุงุฆูุฉ ุงููุงุชูุฑุฉ
- โ ุชุญูู ูู ูุคุดุฑุงุช ุงูุตูุฑ ูู PDF

### **3. ุงุฎุชุจุงุฑ ุณูุฑ ุงูุนูู ุงููุงูู:**
- โ ุฅูุดุงุก ูุงุชูุฑุฉ ุฌุฏูุฏุฉ ูู ุงูุจุฏุงูุฉ ููููุงูุฉ
- โ ุชุตุฏูุฑ PDF ููุดุงุฑูุชู
- โ ุนุฑุถ ุงููุงุชูุฑุฉ ูู ูุงุฆูุฉ ุงูููุงุชูุฑ

**๐ ุฌููุน ุงูุฅุตูุงุญุงุช ุชูุช ุจูุฌุงุญ ูุงููุธุงู ุฌุงูุฒ ููุงุณุชุฎุฏุงู!** ๐

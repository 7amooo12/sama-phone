# دليل اختبار الإصلاحات

## خطوات الاختبار السريع:

### 1. تشغيل التطبيق:
```bash
cd flutter_app/smartbiztracker_new
flutter clean
flutter pub get
flutter run
```

### 2. اختبار تاب العمال في المحاسب:

**خطوات الاختبار:**
1. تسجيل الدخول بحساب المحاسب:
   - الإيميل: `accountant@sama.com` أو `hima@sama.com`
   - كلمة المرور: حسب ما هو مسجل في النظام

2. الانتقال إلى تاب "العمال" (التاب الأخير)

3. **التحقق من النتائج المتوقعة:**
   - ✅ عرض إحصائيات حقيقية (عدد العمال، العمال النشطين، المهام المكتملة، المكافآت)
   - ✅ عرض قائمة العمال الحقيقيين من قاعدة البيانات
   - ✅ عرض تفاصيل كل عامل (الاسم، الإيميل، الهاتف، الحالة)
   - ✅ عرض الصور الشخصية للعمال (إن وجدت)
   - ✅ تمييز العمال النشطين عن غير النشطين بالألوان

### 3. اختبار إدارة المستخدمين في الأدمن:

**خطوات الاختبار:**
1. تسجيل الدخول بحساب الأدمن:
   - الإيميل: `admin@sama.com` أو `admin@samastore.com`
   - كلمة المرور: حسب ما هو مسجل في النظام

2. الانتقال إلى "إدارة المستخدمين" من القائمة الجانبية

3. **التحقق من التبويبات:**
   - **تاب "الكل"**: يجب أن يعرض جميع المستخدمين (11 مستخدم)
   - **تاب "المدراء"**: يعرض المدراء فقط
   - **تاب "المستخدمون"**: يعرض العملاء والعمال والمحاسبين والموظفين
   - **تاب "بانتظار الموافقة"**: يعرض المستخدمين غير المعتمدين

4. **اختبار البحث:**
   - البحث بالاسم
   - البحث بالإيميل
   - البحث برقم الهاتف

### 4. اختبار إسناد المهام:

**خطوات الاختبار:**
1. البقاء في حساب الأدمن

2. الانتقال إلى "إسناد المهام" من القائمة الجانبية

3. **التحقق من قائمة العمال:**
   - ✅ يجب أن تظهر قائمة منسدلة تحتوي على العمال المعتمدين
   - ✅ العمال المتوقعين: `worker@sama.com`, `testw@sama.com`

4. **اختبار إسناد مهمة:**
   - اختيار عامل من القائمة
   - اختيار منتج أو طلب
   - تحديد موعد نهائي
   - الضغط على "تأكيد الإسناد"
   - التحقق من ظهور رسالة نجاح

## المشاكل المحتملة وحلولها:

### إذا لم تظهر العمال في تاب المحاسب:
1. تحقق من وجود عمال في قاعدة البيانات
2. تحقق من أن العمال لديهم `status = 'approved'` أو `status = 'active'`
3. تحقق من RLS policies لجدول `user_profiles`

### إذا لم تظهر المستخدمين في إدارة المستخدمين:
1. تحقق من اتصال قاعدة البيانات
2. تحقق من صلاحيات الأدمن
3. راجع console logs للأخطاء

### إذا لم تظهر العمال في إسناد المهام:
1. تحقق من أن العمال معتمدين (`isApproved = true`)
2. تحقق من حالة العمال (`status = 'approved'` أو `'active'`)
3. راجع console logs لرسائل التشخيص

## رسائل Console المتوقعة:

عند تشغيل التطبيق، يجب أن تظهر رسائل مثل:
```
SUCCESS: Approved workers loaded successfully: 2 workers out of 2 total workers
Worker: اسم العامل (worker@sama.com) - Status: active, Approved: true
Successfully loaded 11 users
User roles: admin: 2, worker: 2, client: 3, accountant: 2, owner: 1
```

## الحسابات المتاحة للاختبار:

### حسابات الأدمن:
- `admin@sama.com` (admin, active)
- `admin@samastore.com` (admin, approved)

### حسابات المحاسبين:
- `accountant@sama.com` (accountant, pending)
- `hima@sama.com` (accountant, active)

### حسابات العمال:
- `worker@sama.com` (worker, active)
- `testw@sama.com` (worker, active)

### حسابات العملاء:
- `client@sama.com` (client, pending)
- `test@sama.com` (client, active)
- `cust@sama.com` (client, active)

### حسابات أخرى:
- `owner@sama.com` (owner, pending)
- `eslam@sama.com` (owner, active)

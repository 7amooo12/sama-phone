# ุญู ูุดููุฉ ุฑูุน ุงูุตูุฑ ุงูุดุฎุตูุฉ ุฅูู Supabase Storage

## ๐ ุชุญููู ุงููุดููุฉ

### ุงูุฎุทุฃ ุงูุฃุตูู:
```json
{
  "event_message": "POST | 400 | https://ivtjacsppwmjgmuskxis.supabase.co/storage/v1/object/public/profile_images/1748508930949jpg",
  "response": {
    "status_code": 400
  }
}
```

### ุงูุฃุณุจุงุจ ุงููุญุชููุฉ:

1. **โ ูุดููุฉ ูู ุงุณู ุงูููู**: `1748508930949jpg` (ููููุฏ ุงูููุทุฉ ูุจู ุงูุงูุชุฏุงุฏ)
2. **โ ุชุถุงุฑุจ ูู ุฃุณูุงุก ุงูุจูุชุงุช**: ุงุณุชุฎุฏุงู ุจูุชุงุช ูุฎุชููุฉ ูู ุฃุฌุฒุงุก ูุฎุชููุฉ ูู ุงูููุฏ
3. **โ ุฅุนุฏุงุฏุงุช ุงูุจูุช**: ุงูุจูุช ูุฏ ูููู ุบูุฑ ููุฌูุฏ ุฃู ุบูุฑ ุนุงู
4. **โ ุตูุงุญูุงุช ุงููุณุชุฎุฏู**: ุนุฏู ูุฌูุฏ ุตูุงุญูุงุช ูุงููุฉ ููุฑูุน

## ๐ง ุงูุญููู ุงููุทุจูุฉ

### 1. ุฅุตูุงุญ ุงุณู ุงูููู

**ูุจู ุงูุฅุตูุงุญ:**
```dart
final fileName = '${DateTime.now().millisecondsSinceEpoch}${_imageFile!.path.split('.').last}';
// ููุชุฌ: 1748508930949jpg
```

**ุจุนุฏ ุงูุฅุตูุงุญ:**
```dart
final extension = _imageFile!.path.split('.').last;
final fileName = '${DateTime.now().millisecondsSinceEpoch}.$extension';
// ููุชุฌ: 1748508930949.jpg
```

### 2. ุชูุญูุฏ ุงุณุชุฎุฏุงู ุฎุฏูุฉ ุงูุชุฎุฒูู

**ูุจู ุงูุฅุตูุงุญ:** ุงุณุชุฎุฏุงู ูุจุงุดุฑ ูู Supabase client
```dart
await _supabase.storage.from('public').upload(filePath, _imageFile!);
```

**ุจุนุฏ ุงูุฅุตูุงุญ:** ุงุณุชุฎุฏุงู ุฎุฏูุฉ ุงูุชุฎุฒูู ุงููุญุณูุฉ
```dart
final imageUrl = await _profileStorageService.updateProfileImage(userId, _imageFile!);
```

### 3. ุฅุถุงูุฉ ุฃุฏูุงุช ุงูุชุดุฎูุต

#### ุฃ. StorageDebugHelper
- ูุญุต ุงูุจูุชุงุช ุงูููุฌูุฏุฉ
- ุฅูุดุงุก ุงูุจูุชุงุช ุงูููููุฏุฉ
- ุงุฎุชุจุงุฑ ุฑูุน ุงููููุงุช
- ูุญุต ุตูุงุญูุงุช ุงููุณุชุฎุฏู

#### ุจ. StorageDebugScreen
- ูุงุฌูุฉ ูุฑุฆูุฉ ููุญุต ูุดุงูู ุงูุชุฎุฒูู
- ุนุฑุถ ุงูุณุฌูุงุช ูู ุงูููุช ุงููุนูู
- ุงุฎุชุจุงุฑ ุฑูุน ุงูุตูุฑ

## ๐ ููููุฉ ุงุณุชุฎุฏุงู ุฃุฏูุงุช ุงูุชุดุฎูุต

### 1. ุงููุตูู ูุดุงุดุฉ ุงูุชุดุฎูุต
```dart
Navigator.pushNamed(context, '/debug/storage');
```

### 2. ุชุดุบูู ุงููุญุต ุงูุดุงูู
```dart
await StorageDebugHelper.runAllChecks();
```

### 3. ูุญุต ุงูุจูุชุงุช ููุท
```dart
await StorageDebugHelper.checkBuckets();
```

## ๐ ุฎุทูุงุช ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### 1. ูุญุต ุงูุจูุชุงุช
```bash
# ูู ุดุงุดุฉ ุงูุชุดุฎูุตุ ุงุถุบุท ุนูู "ูุญุต ุงูุจูุชุงุช"
# ุชุญูู ูู ูุฌูุฏ ุจูุช profile_images
# ุชุญูู ูู ุฃู ุงูุจูุช ุนุงู (public: true)
```

### 2. ุงุฎุชุจุงุฑ ุฑูุน ุตูุฑุฉ
```bash
# ูู ุดุงุดุฉ ุงูุชุดุฎูุตุ ุงุถุบุท ุนูู "ุงุฎุชุจุงุฑ ุฑูุน ุตูุฑุฉ"
# ุงุฎุชุฑ ุตูุฑุฉ ูู ุงููุนุฑุถ
# ุฑุงูุจ ุงูุณุฌู ููุฃุฎุทุงุก
```

### 3. ูุญุต ุตูุงุญูุงุช ุงููุณุชุฎุฏู
```bash
# ูู ุดุงุดุฉ ุงูุชุดุฎูุตุ ุงุถุบุท ุนูู "ูุญุต ุดุงูู"
# ุชุญูู ูู ุชุณุฌูู ุฏุฎูู ุงููุณุชุฎุฏู
# ุชุญูู ูู ุตูุงุญูุงุช ุงููุณุชุฎุฏู
```

## ๐ ุฑุณุงุฆู ุงูุฎุทุฃ ุงูุดุงุฆุนุฉ ูุญููููุง

### 1. "ุงูุจูุช ุบูุฑ ููุฌูุฏ"
```bash
ุงูุญู: ุณูุชู ุฅูุดุงุก ุงูุจูุช ุชููุงุฆูุงู ุจูุงุณุทุฉ StorageDebugHelper
```

### 2. "ุงูุจูุช ููุณ ุนุงู"
```bash
ุงูุญู: ุชุญุฏูุซ ุฅุนุฏุงุฏุงุช ุงูุจูุช ูู Supabase Dashboard
```

### 3. "ุงููุณุชุฎุฏู ุบูุฑ ูุณุฌู ุฏุฎูู"
```bash
ุงูุญู: ุชุณุฌูู ุฏุฎูู ุงููุณุชุฎุฏู ุฃููุงู
```

### 4. "ุญุฌู ุงูููู ูุจูุฑ ุฌุฏุงู"
```bash
ุงูุญู: ุถุบุท ุงูุตูุฑุฉ ูุจู ุงูุฑูุน (ูุทุจู ูู ProfileStorageService)
```

## ๐ ูุฑุงูุจุฉ ุงูุฃุฏุงุก

### ุงูุณุฌูุงุช
- ุฌููุน ุงูุนูููุงุช ุชุณุฌู ูู AppLogger
- ุฑุณุงุฆู ููููุฉ ุญุณุจ ููุน ุงูุฑุณุงูุฉ (ุฎุทุฃุ ุชุญุฐูุฑุ ูุนูููุงุช)
- ุญูุธ ุงูุณุฌูุงุช ูู ูููุงุช ูุญููุฉ

### ุงูููุงููุณ
- ููุช ุงูุฑูุน
- ุญุฌู ุงูููู ูุจู ูุจุนุฏ ุงูุถุบุท
- ูุนุฏู ูุฌุงุญ ุงูุนูููุงุช

## ๐ก๏ธ ุงูุฃูุงู

### ุงูุชุญูู ูู ููุน ุงูููู
```dart
final allowedTypes = ['jpg', 'jpeg', 'png', 'webp'];
if (!allowedTypes.contains(extension.toLowerCase())) {
  throw Exception('ููุน ุงูููู ุบูุฑ ูุฏุนูู');
}
```

### ุญุฏ ุญุฌู ุงูููู
```dart
const maxSize = 10 * 1024 * 1024; // 10MB
if (fileSize > maxSize) {
  throw Exception('ุญุฌู ุงูููู ูุจูุฑ ุฌุฏุงู');
}
```

### ุถุบุท ุงูุตูุฑุฉ
```dart
// ุชูููู ุงูุญุฌู ุฅูู 800x800 ูุญุฏ ุฃูุตู
// ุถุบุท ุจุฌูุฏุฉ 90%
// ุชุญููู ุฅูู JPEG
```

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ

1. **ุงุฎุชุจุงุฑ ุงูุญู**: ุงุณุชุฎุฏู ุดุงุดุฉ ุงูุชุดุฎูุต ูุงุฎุชุจุงุฑ ุฑูุน ุงูุตูุฑ
2. **ูุฑุงูุจุฉ ุงูุณุฌูุงุช**: ุชุงุจุน ุงูุณุฌูุงุช ููุชุฃูุฏ ูู ุนุฏู ูุฌูุฏ ุฃุฎุทุงุก
3. **ุชุญุณูู ุงูุฃุฏุงุก**: ุฅุถุงูุฉ ุงููุฒูุฏ ูู ุงูุชุญุณููุงุช ุญุณุจ ุงูุญุงุฌุฉ
4. **ุชูุซูู ุงูุฃุฎุทุงุก**: ุชุณุฌูู ุฃู ุฃุฎุทุงุก ุฌุฏูุฏุฉ ูุญููููุง

## ๐ ุงูุฏุนู

ุฅุฐุง ุงุณุชูุฑุช ุงููุดููุฉ:
1. ุชุดุบูู ุงููุญุต ุงูุดุงูู ูุญูุธ ุงูุณุฌู
2. ุงูุชุญูู ูู ุฅุนุฏุงุฏุงุช Supabase
3. ูุฑุงุฌุนุฉ ุตูุงุญูุงุช ุงููุณุชุฎุฏู
4. ุงูุชูุงุตู ูุน ูุฑูู ุงูุฏุนู ูุน ุงูุณุฌูุงุช
